
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.5">
    
    
      
        <title>AWS Private CA Issuer Add-on - Amazon EKS Blueprints Quick Start</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bde7dde4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ef6f36e2.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#aws-private-ca-issuer-add-on" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Amazon EKS Blueprints Quick Start" class="md-header__button md-logo" aria-label="Amazon EKS Blueprints Quick Start" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Amazon EKS Blueprints Quick Start
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              AWS Private CA Issuer Add-on
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/aws-quickstart/cdk-eks-blueprints/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    aws-quickstart/cdk-eks-blueprints
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Amazon EKS Blueprints Quick Start" class="md-nav__button md-logo" aria-label="Amazon EKS Blueprints Quick Start" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Amazon EKS Blueprints Quick Start
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/aws-quickstart/cdk-eks-blueprints/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    aws-quickstart/cdk-eks-blueprints
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../core-concepts/" class="md-nav__link">
        Core Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../teams/" class="md-nav__link">
        Teams
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../pipelines/" class="md-nav__link">
        Pipelines
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        AddOns
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="AddOns" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          AddOns
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../adot-addon/" class="md-nav__link">
        ADOT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../amp-addon/" class="md-nav__link">
        AMP ADOT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../app-mesh/" class="md-nav__link">
        AWS App Mesh
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../argo-cd/" class="md-nav__link">
        ArgoCD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws-for-fluent-bit/" class="md-nav__link">
        AWS For Fluent Bit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws-load-balancer-controller/" class="md-nav__link">
        AWS Load Balancer Controller
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws-node-termination-handler/" class="md-nav__link">
        AWS Node Termination Handler
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../calico-operator/" class="md-nav__link">
        Calico Operator
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../cert-manager/" class="md-nav__link">
        Certificate Manager
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../cloudwatch-adot-addon/" class="md-nav__link">
        CloudWatch ADOT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../cluster-autoscaler/" class="md-nav__link">
        Cluster Autoscaler
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../container-insights/" class="md-nav__link">
        Container Insights
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../coredns/" class="md-nav__link">
        CoreDns
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../datadog/" class="md-nav__link">
        Datadog
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/dynatrace-oss/dynatrace-eks-blueprints-addon" class="md-nav__link">
        Dynatrace
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ebs-csi-driver/" class="md-nav__link">
        EBS CSI Driver
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../efs-csi-driver/" class="md-nav__link">
        EFS CSI Driver
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../external-dns/" class="md-nav__link">
        External DNS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../karpenter/" class="md-nav__link">
        Karpenter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/keptn-sandbox/keptn-eks-blueprints-addon" class="md-nav__link">
        Keptn
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../kube-proxy/" class="md-nav__link">
        Kube Proxy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../kubecost/" class="md-nav__link">
        Kubecost
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../kubevious/" class="md-nav__link">
        Kubevious
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics-server/" class="md-nav__link">
        Metrics Server
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../newrelic/" class="md-nav__link">
        New Relic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nginx/" class="md-nav__link">
        Nginx
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../opa-gatekeeper/" class="md-nav__link">
        OPA Gatekeeper
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../pixie/" class="md-nav__link">
        Pixie
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../rafay/" class="md-nav__link">
        Rafay
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../secrets-store/" class="md-nav__link">
        Secrets Store
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/snyk-partners/snyk-monitor-eks-blueprints-addon" class="md-nav__link">
        Snyk
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ssm-agent/" class="md-nav__link">
        SSM Agent
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../velero/" class="md-nav__link">
        Velero
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../vpc-cni/" class="md-nav__link">
        Vpc Cni
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../xray/" class="md-nav__link">
        AWS XRay
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../xray-adot-addon/" class="md-nav__link">
        AWS XRay ADOT
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        Cluster Providers
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Cluster Providers" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Cluster Providers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../cluster-providers/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../cluster-providers/generic-cluster-provider/" class="md-nav__link">
        Generic Cluster Provider
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../cluster-providers/asg-cluster-provider/" class="md-nav__link">
        ASG Cluster Provider
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../cluster-providers/mng-cluster-provider/" class="md-nav__link">
        MNG Cluster Provider
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../cluster-providers/fargate-cluster-provider/" class="md-nav__link">
        Fargate Cluster Provider
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      <label class="md-nav__link" for="__nav_8">
        Resource Providers
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Resource Providers" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Resource Providers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../resource-providers/" class="md-nav__link">
        Resource Providers
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../extensibility/" class="md-nav__link">
        Extensibility
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../api" class="md-nav__link">
        API Reference
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    Usage
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-options" class="md-nav__link">
    Configuration Options
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cert-manager-compatibility-with-eks-and-fargate" class="md-nav__link">
    cert-manager compatibility with EKS and Fargate
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#validation" class="md-nav__link">
    Validation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing" class="md-nav__link">
    Testing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    Troubleshooting
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/aws-quickstart/cdk-eks-blueprints/edit/master/docs/addons/aws-privateca-issuer.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="aws-private-ca-issuer-add-on">AWS Private CA Issuer Add-on<a class="headerlink" href="#aws-private-ca-issuer-add-on" title="Permanent link">&para;</a></h1>
<p>This addon will install <a href="https://github.com/cert-manager/aws-privateca-issuer/">aws-privateca-issuer</a></p>
<p>AWS ACM Private CA is a module of the AWS Certificate Manager that can setup and manage private CAs.
The AWS PrivateCA Issuer plugin acts as an addon to cert-manager that signs certificate requests using ACM Private CA.</p>
<p>Since its an addon to cert-manager, for Installing AWS ACM Private CA Addon, You must install <a href="https://github.com/aws-quickstart/cdk-eks-blueprints/blob/main/docs/addons/cert-manager.md">cert-manager</a> Addon first</p>
<p><a href="https://github.com/aws-quickstart/cdk-eks-blueprints/blob/main/docs/addons/cert-manager.md">cert-manager</a> is a Kubernetes add-on to automate the management and issuance of TLS certificates from various issuing sources. It will ensure certificates are valid and up to date periodically, and attempt to renew certificates at an appropriate time before expiry.</p>
<h2 id="usage">Usage<a class="headerlink" href="#usage" title="Permanent link">&para;</a></h2>
<p>Please ensure that <a href="https://github.com/aws-quickstart/cdk-eks-blueprints/blob/main/docs/addons/cert-manager.md">cert-manager</a> addon is already installed</p>
<div class="highlight"><pre><span></span><code><span class="k">import</span> <span class="s1">&#39;source-map-support/register&#39;</span><span class="p">;</span>
<span class="k">import</span> <span class="o">*</span> <span class="kr">as</span> <span class="nx">cdk</span> <span class="k">from</span> <span class="s1">&#39;aws-cdk-lib&#39;</span><span class="p">;</span>
<span class="k">import</span> <span class="o">*</span> <span class="kr">as</span> <span class="nx">blueprints</span> <span class="k">from</span> <span class="s1">&#39;@aws-quickstart/eks-blueprints&#39;</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">cdk</span><span class="p">.</span><span class="nx">App</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">awsPcaParams</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">iamPolicies</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;AWSCertificateManagerPrivateCAFullAccess&quot;</span><span class="p">]</span>
<span class="p">}</span>
<span class="kd">const</span> <span class="nx">addOn</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">blueprints</span><span class="p">.</span><span class="nx">addons</span><span class="p">.</span><span class="nx">AWSPrivateCAIssuerAddon</span><span class="p">(</span><span class="nx">awsPcaParams</span><span class="p">)</span>

<span class="kd">const</span> <span class="nx">blueprint</span> <span class="o">=</span> <span class="nx">blueprints</span><span class="p">.</span><span class="nx">EksBlueprint</span><span class="p">.</span><span class="nx">builder</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">addOns</span><span class="p">(</span><span class="nx">addOn</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">build</span><span class="p">(</span><span class="nx">app</span><span class="p">,</span> <span class="s1">&#39;my-stack-name&#39;</span><span class="p">);</span>
</code></pre></div>
<h2 id="configuration-options">Configuration Options<a class="headerlink" href="#configuration-options" title="Permanent link">&para;</a></h2>
<ul>
<li><code>serviceAccountName</code>: (string) User provided name for service account. The default value is aws-pca-issuer</li>
<li><code>iamPolicies</code> - An array of Managed IAM Policies which Service Account needs for IRSA Eg: irsaRoles:["AWSCertificateManagerPrivateCAFullAccess"]. If not empty the Service Account will be created by the CDK with IAM Roles Mapped (IRSA). In case if its empty,  Service Account will be created with out default IAM Policy - "AWSCertificateManagerPrivateCAFullAccess"</li>
<li><code>values</code>: Arbitrary values to pass to the chart. Refer to the aws-pca-issuer <a href="https://github.com/cert-manager/aws-privateca-issuer/blob/main/charts/aws-pca-issuer/values.yaml">Helm Chart Values</a> for additional details. It also supports all standard helm configuration options ( for Eg: https://github.com/aws-quickstart/cdk-eks-blueprints/blob/main/docs/addons/index.md#standard-helm-add-on-configuration-options)</li>
</ul>
<h2 id="cert-manager-compatibility-with-eks-and-fargate">cert-manager compatibility with EKS and Fargate<a class="headerlink" href="#cert-manager-compatibility-with-eks-and-fargate" title="Permanent link">&para;</a></h2>
<p>Please refer to the cert-manager compatibility and open issues with EKS and Fargate
[cert-manager compatibility with EKS](https://cert-manager.io/docs/installation/compatibility/#aws-eks_</p>
<h2 id="validation">Validation<a class="headerlink" href="#validation" title="Permanent link">&para;</a></h2>
<p>To validate that aws-pca-issuer is installed properly in the cluster, check if the namespace aws-pca-issuer is created </p>
<p>Verify if the namespace is created correctly
<div class="highlight"><pre><span></span><code>  kubectl get ns <span class="p">|</span> grep <span class="s2">&quot;aws-pca-issuer&quot;</span>
</code></pre></div>
There should be list the pca namespace
<div class="highlight"><pre><span></span><code>aws-pca-issuer      Active   31m
</code></pre></div>
Verify the objects under namespace aws-pca-issuer 
<div class="highlight"><pre><span></span><code>  kubectl get all -n aws-pca-issuer 
</code></pre></div>
It should give results as below
For Eg:
<div class="highlight"><pre><span></span><code>NAME                                                       READY   STATUS    RESTARTS   AGE
pod/aws-pca-issuer-aws-privateca-issuer-7b9df7c7cc-vz8hw   <span class="m">1</span>/1     Running   <span class="m">0</span>          3m2s

NAME                                          TYPE        CLUSTER-IP      EXTERNAL-IP   PORT<span class="o">(</span>S<span class="o">)</span>    AGE
service/aws-pca-issuer-aws-privateca-issuer   ClusterIP   <span class="m">172</span>.20.17.134   &lt;none&gt;        <span class="m">8080</span>/TCP   3m3s

NAME                                                  READY   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/aws-pca-issuer-aws-privateca-issuer   <span class="m">1</span>/1     <span class="m">1</span>            <span class="m">1</span>           3m2s
</code></pre></div></p>
<h2 id="testing">Testing<a class="headerlink" href="#testing" title="Permanent link">&para;</a></h2>
<p>1) Create an ACM Private CA
For this testing <a href="https://docs.aws.amazon.com/acm-pca/latest/userguide/PcaCreateCa.html#CA-procedures">create</a> a private certificate authority in ACM Private CA with RSA 2048 selected as the key algorithm. You can create a CA using the AWS console
Once your private CA is active note down the ARN</p>
<p>2) Create a K8s namespace for testing purpose
<div class="highlight"><pre><span></span><code>  kubectl create ns acm-pca-demo
</code></pre></div>
3) Change the current context to namespace acm-pca-demo
<div class="highlight"><pre><span></span><code>  kubectl config set-context --current --namespace<span class="o">=</span>acm-pca-demo
</code></pre></div>
4) Create CRD AWSPCAIssuer with name demo-awspcs-issuer  &gt;&gt; AWSPCAIssuer.yaml</p>
<p>AWSPCAIssuer
This is a regular namespaced issuer that can be used as a reference in your Certificate CRs.
AWSPCAClusterIssuer
This CR is identical to the AWSPCAIssuer. The only difference being that itâ€™s not namespaced and can be referenced from anywhere.</p>
<p>In thi example we will use  AWSPCAIssuer
Replace the arn
Replace ${AWS_REGION} with your target region and ${ARN} with the ARN of CM Private CA recieved from step 1
<div class="highlight"><pre><span></span><code><span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">awspca.cert-manager.io/v1beta1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AWSPCAIssuer</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">demo-awspcs-issuer</span>
  <span class="nt">namespace</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">acm-pca-demo</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">arn</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">${ARN}</span>
  <span class="nt">region</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">${AWS_REGION}</span>
<span class="nn">---</span>
</code></pre></div>
Apply the yaml file
<div class="highlight"><pre><span></span><code>  kubectl apply -f AWSPCAIssuer.yaml
</code></pre></div>
Verify AWSPCAIssuer installed correctly
<div class="highlight"><pre><span></span><code>  kubectl describe AWSPCAIssuer 
</code></pre></div>
Check the Events section and you must see the message Issuer verified if everything goes correct
<div class="highlight"><pre><span></span><code> Normal  Verified  46s <span class="o">(</span>x2 over 46s<span class="o">)</span>  awspcaissuer-controller  Issuer verified
</code></pre></div>
4) Create CRD Certificate with name rsa-cert-2048 for dns name rsa-2048.example.com  &gt;&gt; Certificate.yaml
For th formats other than 2048 check the <a href="https://github.com/cert-manager/aws-privateca-issuer/tree/main/config/examples/certificates">examples</a>
<div class="highlight"><pre><span></span><code><span class="nn">---</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Certificate</span>
<span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cert-manager.io/v1</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">rsa-cert-2048</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">commonName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">www.rsa-2048.example.com</span>
  <span class="nt">dnsNames</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">www.rsa-2048.example.com</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">rsa-2048.example.com</span>
  <span class="nt">duration</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2160h0m0s</span>
  <span class="nt">issuerRef</span><span class="p">:</span>
    <span class="nt">group</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">awspca.cert-manager.io</span>
    <span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AWSPCAIssuer</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">demo-awspcs-issuer</span>
  <span class="nt">renewBefore</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">360h0m0s</span>
  <span class="nt">secretName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">rsa-example-cert-2048</span>
  <span class="nt">usages</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">server auth</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">client auth</span>
  <span class="nt">privateKey</span><span class="p">:</span>
    <span class="nt">algorithm</span><span class="p">:</span> <span class="s">&quot;RSA&quot;</span>
    <span class="nt">size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2048</span>
<span class="nn">---</span>
</code></pre></div>
Apply the yaml file
<div class="highlight"><pre><span></span><code>  kubectl apply -f Certificate.yaml
</code></pre></div>
Verify Certificate is installed correctly
<div class="highlight"><pre><span></span><code>  kubectl  get Certificates
</code></pre></div>
It should output Ready as True as shown below
<div class="highlight"><pre><span></span><code>  NAME            READY   SECRET                  AGE
  rsa-cert-2048   True    rsa-example-cert-2048   31s
</code></pre></div>
The actual certificate file is stored as a secret. To see the details of secret get the secret name
<div class="highlight"><pre><span></span><code>  k describe certificate <span class="p">|</span> grep Secret
</code></pre></div>
Output
<div class="highlight"><pre><span></span><code>  Secret Name:   rsa-example-cert-2048
</code></pre></div>
Describe the secret to get the value
<div class="highlight"><pre><span></span><code>  kubectl describe secret rsa-example-cert-2048
</code></pre></div></p>
<h2 id="troubleshooting">Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permanent link">&para;</a></h2>
<p>Please use kubectl get events for debugging. 
<div class="highlight"><pre><span></span><code>  kubectl get events  
</code></pre></div>
Sample Output for Successfull Certificate Request
<div class="highlight"><pre><span></span><code>  5s          Normal   cert-manager.io   certificaterequest/rsa-cert-2048.io-zqftp   Certificate request has been approved by cert-manager.io
  2s          Normal   Issued            certificaterequest/rsa-cert-2048.io-zqftp   certificate issued
  5s          Normal   Issuing           certificate/rsa-cert-2048                Issuing certificate as Secret does not exist
  5s          Normal   Generated         certificate/rsa-cert-2048               Stored new private key <span class="k">in</span> temporary Secret resource <span class="s2">&quot;rsa-cert-2048-k7zxv&quot;</span>
  5s          Normal   Requested         certificate/rsa-cert-2048                Created new CertificateRequest resource <span class="s2">&quot;rsa-cert-2048-zqftp&quot;</span>
  2s          Normal   Issuing           certificate/rsa-cert-2048                The certificate has been successfully issued
  8m22s       Normal   Verified          awspcaissuer/rsa-cert-2048               Issuer verified
  85s         Normal   Verified          awspcaissuer/rsa-cert-2048               Issuer verified
</code></pre></div></p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["tabs"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.d351de03.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.a1609d9a.min.js"></script>
      
    
  </body>
</html>